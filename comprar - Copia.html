<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mari's Wedding Cake - Compre seu bolo de casamento</title>

    <link rel="stylesheet" href="css/estilos.css">
    <link rel="stylesheet" href="css/grid.css">

</head>

<body>

    <div class="corpo">
        <header class="conteudo verdinho bordas limpa">
            <a href="index.html" title="Mari's Wedding Cake">
                <img src="img/logo.png" alt="Logo do site" title="Mari's Wedding Cake" class="logo bordas">
            </a>
            <nav class="menu bordas">
                <ul>
                    <li><a href="index.html" title="Home">Home</a></li>
                    <li><a href="quemSomos.html" title="Quem somos?">Quem somos?</a></li>
                    <li><a href="localiza.html" title="Localização">Onde estamos</a></li>
                </ul>

            </nav>
        </header>

    </div>

    <section class="corpo limpa">
        <div class="conteudo">
            <h1 class="tituloDestaque">Comprando seu Bolo</h1>
            <p>Todos os preços do site são para bolos de 12kg (serve 120 pessoas). Para pedidos especiais fale conosco.</p>
            <p>Lembrando que a retirada dos bolos é de responsabilidade do cliente.</p>
        </div>
    </section>

    <section class="limpa">
        <div class="conteudo">

            <form class="caixa caixa12 bordas sombras" id="pedido" action="#"  name="pedido" onsubmit="return enviar(this)">

                <p><label class="titulo">Sabores</label></p>
                <p class="textoVerde"><input type="checkbox" name="sabor" value="816" />Chocolate Clássico - R$816,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="816" />Morango Clássico - R$816,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="840" />Novidade de Churros - R$840,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="696" />Mousse de Limão - R$696,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="924" />Nozes e Doce de Leite -
                    R$924,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="840" />Frutas Vermelhas - R$840,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="900" />Mousse de Leite Ninho -
                    R$900,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="840" />Delícia de Prestígio - R$840,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="984" />Nutela com Castanhas - R$984,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="900" />Delícia de Oreo - R$900,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="1020" />Surpresa Red Velvet -
                    R$1020,00</p>

                <p class="textoVerde"><input type="checkbox" name="sabor" value="864" />Bolo Crocante - R$864,00</p>

                <p><label class="titulo">Modelo - Acréscimo</label></p>
                <p class="textoVerde"><input type="radio" name="modelo" value="250" />Frutas - R$250,00</p>

                <p class="textoVerde"><input type="radio" name="modelo" value="300" />Escrito - R$300,00</p>

                <p class="textoVerde"><input type="radio" name="modelo" value="250" />Branco - R$250,00</p>

                <p class="textoVerde"><input type="radio" name="modelo" value="200" />Suculentas - R$200,00</p>

                <p class="textoVerde"><input type="radio" name="modelo" value="350" />Flores - R$350,00</p>

                <p class="textoVerde"><input type="radio" name="modelo" value="200" />Metálico - R$200,00</p>

                <p class="textoVerde"><input type="radio" name="modelo" value="400" />Mini Bolo - R$400,00</p>

                <p class="textoVerde"><input type="radio" name="modelo" value="400" />Pintado - R$400,00</p>

                <p><label class="titulo">Total a pagar</label> </p>
                <div>
                    <p><input name="total" type="text" readonly disabled>
                        <input type="hidden" name="hiddentotal" value="0"></p>
                </div>

                <p><label class="titulo">Pagamento</label></p>

                <p><select id="options" name="pagamento" onchange="optionCheck()">
                        <option value="hide1">Selecione forma de Pagamento</option>
                        <option value="hide">Débito</option>
                        <option value="hide">Crédito</option>
                        <option value="show">Dinheiro na retirada</option>
                    </select></p>

                <div id="hiddenDiv" style="visibility:hidden">
                    <p><input type="text" name="valor" id="valor" placeholder="Digite o valor para calcularmos seu troco."
                            maxlength="14" value=""></p>
                </div>

                <p><label class="titulo">Dados</label></p>
                <p><input type="text" name="nome" placeholder="Nome">
                    <input type="email" name="email" placeholder="E-mail">
                    <textarea name="mensagem" rows="5" placeholder="Mensagem"></textarea>
                </p>


                <input type="submit" id="envioPedido" value="Ver Pedido" class="botao bordas">

            </form>

            <div id="content"></div>

        </div>
    </section>


    <script type="text/javascript">

        // Mostra o campo do valor em dinheiro
        function optionCheck() {
            var option = document.getElementById("options").value;
            if (option == "show") {
                document.getElementById("hiddenDiv").style.visibility = "visible";
            }
            if (option == "hide") {
                document.getElementById("hiddenDiv").style.visibility = "hidden";
            }
            if (option == "hide1") {
                document.getElementById("hiddenDiv").style.visibility = "hidden";
            }
        }


        //Converte valores dos check e radios

        // Formata o valor do dinheiro ex: R$ 1.200,30
        function converteValor() {
            let valor = document.contrato.valor.value;
            valor = valor * 1.10;
            valor = Number(valor).toLocaleString("pt-BR", {style: 'currency', currency:'BRL'});
            return valor;
        }
        function formatCurrency(num) {
            num = num.toString().replace(/\$|\,/g, '');
            if (isNaN(num)) num = "0";
            cents = Math.floor((num * 100 + 0.5) % 100);
            num = Math.floor((num * 100 + 0.5) / 100).toString();
            if (cents < 10) cents = "0" + cents;
            for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++)
                num = num.substring(0, num.length - (4 * i + 3)) + '.' + num.substring(num.length - (4 * i + 3));
            return ("" + num + "," + cents);
        }

        //Somar valores bolos
        var form = document.forms[0];
        var inputs = form.querySelectorAll('input[type=checkbox],input[type=radio]');
        // iterar todos os inputs
        for (var i = 0; i < inputs.length; i++) {
            // vincular função ao evento "change"
            inputs[i].addEventListener('change', function () {
                var soma = 0;
                for (var j = 0; j < inputs.length; j++) {
                    if (inputs[j].checked) {
                        // interpreta como float, usando parseFloat ao invés de eval
                        soma += parseFloat(inputs[j].value);
                    }
                }
                form.hiddentotal.value = soma; // atribui valor ao campo oculto
                form.total.value = formatCurrency(soma) // exibe valor formatado
            }, false);
        }

        //Verifica elemento checado
        function sabores(formDados) {
            for (let i = 0; i < formDados.sabor.length; i++) {
                const element = formDados.sabor[i];
                if (element.checked) {
                    return true;
                }
            }
            return false;
        }

        //Converter número digitado no dinheiro para troco
            var dinheiroTroco = document.getElementById("valor").value;
            dinheiroTroco = formatCurrency(dinheiroTroco);
            

        //Calcular o troco
        var troco = soma - dinheiroTroco;


        //Validação do Formulário
        function enviar(formDados) {
            if (!sabores(formDados)) {
                alert("O campo \"Sabores\" não está selecionado!\n\nPor favor selecione um item no campo \"Sabores\".")
                formDados.sabores[0].focus();
                return false;
            }

            var modeloOk = false;
            for (var i = 0; i < formDados.modelo.length; i++) {
                if (formDados.modelo[i].checked)
                    modeloOk = true;
            }
            if (!modeloOk) {
                alert("O campo \"Modelo\" não está selecionado!\n\nPor favor selecione um item no campo \"Modelo\".")
                formDados.modelo[0].focus();
                return false;
            }

            if (formDados.nome.value == "") {
                alert("Digite seu \"Nome\".");
                formDados.nome.focus();
                return false;
            }

            if (formDados.mensagem.value == "") {
                alert("Digite uma mensagem com especificações \"Mensagem\".");
                formDados.mensagem.focus();
                return false;
            }

            if (formDados.email.value == "") {
                alert("Digite seu \"E-mail\".");
                formDados.email.focus();
                return false;
            }

            var comboPag = document.getElementById("options");
            if (comboPag.options[comboPag.selectedIndex].value == "hide1") {
                alert("O campo \"Pagamento\" não está selecionado!\n\nPor favor selecione um item no campo \"Forma de pagamento\".")
                formDados.pagamento.focus();
                return false;
            }
            //Arrumar
            if (comboPag.options[comboPag.selectedIndex].value == "show") {
                if (document.getElementById("valor").value == ""|| formatCurrency(document.getElementById("valor").value) < soma) {
                    alert("Digite um valor válido");
                    formDados.valor.focus();
                    return false;
                }
            }

            alert("Dados OK")
            return true;
            

        }

        // Retorna data
        function converteData() {
            let month = ["janeiro", "fevereiro", "março", "abril", "maio", "junho",
                "julho", "agosto", "setembro", "outubro", "novembro", "dezembro"];
            const date = new Date();
            let data = "Jundiaí, " + date.getDate() + " de " + month[date.getMonth()]
                + " de " + date.getFullYear();
            // ex: "20 de janeiro de 2019"
            return data;
        }

        // Impressão da data e pedido completo
        




    </script>


    <footer>
        <div class="conteudo ">
            <p>&copy; 2019 - Mari's Wedding Cake - Seu bolo com carinho</p>
            <ul class="social">
                <li>
                    <a href="#" title="Twitter" target="_blank">
                        <img src="img/twitter.png" title="Twitter" alt="Twitter">
                    </a>
                </li>
                <li>
                    <a href="https://www.facebook.com/mariana.alcantaragarcia" title="Facebook" target="_blank">
                        <img src="img/facebook.png" title="Facebook" alt="Facebook">
                    </a>
                </li>
            </ul>
        </div>
    </footer>

</body>


</html>